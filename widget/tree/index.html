<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Виджет "Дерево иерархии устройств"</title>

  <!-- Внешние библиотеки: jsTree стили -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.12/themes/default/style.min.css">

  <!-- Стили виджета -->
  <link rel="stylesheet" href="./css/style.css">
</head>
<body>

  <!-- Кнопка для открытия/закрытия настроек (только иконка шестеренки) -->
  <button id="settings-toggle" title="Настройки">⚙️</button>

  <!-- Панель настроек -->
  <div id="settings-panel">
    <div class="settings-row">
      <label>Поле ID устройства:</label>
      <input type="text" id="field-id" value="NMO_BaseName" placeholder="NMO_BaseName">
    </div>
    <div class="settings-row">
      <label>Поле родителя:</label>
      <input type="text" id="field-parent" value="HeadDeviceName" placeholder="HeadDeviceName">
    </div>
    <div class="settings-row">
      <label>Поле флага иерархии:</label>
      <input type="text" id="field-flag" value="icanbeheadunit" placeholder="icanbeheadunit">
    </div>
    <div class="settings-row">
      <label>Поле отображения:</label>
      <input type="text" id="field-display" value="NMO_BaseName" placeholder="Оставьте пустым = ID">
    </div>
    <div class="settings-row">
      <label title="В настоящее время фильтрация применяется только к текущей таблице из-за ограничений Grist API">Целевая таблица для фильтрации:*:</label>
      <select id="target-table" title="В настоящее время фильтрация применяется только к текущей таблице из-за ограничений Grist API">
        <option value="">Текущая таблица</option>
      </select>
      <small>*Функция в разработке. В текущей версии Grist фильтрация применяется только к текущей таблице.</small>
    </div>
  </div>

  <!-- Контейнер дерева -->
  <div id="tree"></div>

  <!-- Статус-бар -->
  <div id="status">
    <span class="loading"></span>
    <span id="status-text">Инициализация...</span>
  </div>

  <!-- Внешние библиотеки -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.12/jstree.min.js"></script>
  <script src="./grist-plugin-api.js"></script>

  <!-- Модули приложения (загружаются в правильном порядке) -->
  <script src="./js/config.js"></script>
  <script src="./js/grist-api.js"></script>
  <script src="./js/hierarchy.js"></script>
  <script src="./js/ui.js"></script>
  <script src="./js/app.js"></script>

</body>
</html>
