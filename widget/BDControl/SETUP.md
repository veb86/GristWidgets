# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏–¥–∂–µ—Ç–∞ BDControl –≤ Grist

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ç–∞–±–ª–∏—Ü–∞–º

–ü–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –≤–∏–¥–∂–µ—Ç–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ Grist —Å–æ–∑–¥–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã:

### 1. –¢–∞–±–ª–∏—Ü–∞ `device_groups`

| –°—Ç–æ–ª–±–µ—Ü    | –¢–∏–ø          | –û–ø–∏—Å–∞–Ω–∏–µ                          |
| ---------- | ------------ | --------------------------------- |
| id         | Int (–∫–ª—é—á)   | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –≥—Ä—É–ø–ø—ã              |
| manualSort | Int          | –ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏                |
| parent_id  | Int          | –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –≥—Ä—É–ø–ø–∞ (0 = –∫–æ—Ä–Ω–µ–≤–∞—è)|
| code       | Text         | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–¥ –≥—Ä—É–ø–ø—ã            |
| name       | Text         | –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –≥—Ä—É–ø–ø—ã           |

### 2. –¢–∞–±–ª–∏—Ü–∞ `device`

| –°—Ç–æ–ª–±–µ—Ü              | –¢–∏–ø        | –û–ø–∏—Å–∞–Ω–∏–µ                     |
| -------------------- | ---------- | ---------------------------- |
| id                   | Int (–∫–ª—é—á) | ID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞                |
| name                 | Text       | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ                 |
| brand                | Text       | –ú–æ–¥–µ–ª—å                       |
| factoryname          | Text       | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å                |
| devgroup_id          | Int        | ID –≥—Ä—É–ø–ø—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞         |
| gristHelper_Display2 | Text       | –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –≥—Ä—É–ø–ø—ã      |
| unit                 | Text       | –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è            |
| count                | Text       | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ                   |
| note                 | Text       | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ                   |

### 3. –¢–∞–±–ª–∏—Ü–∞ `SYSTEM`

| –°—Ç–æ–ª–±–µ—Ü | –¢–∏–ø        | –û–ø–∏—Å–∞–Ω–∏–µ           |
| ------- | ---------- | ------------------ |
| id      | Int (–∫–ª—é—á) | ID –∑–∞–ø–∏—Å–∏          |
| param   | Text       | –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ |
| value   | Text       | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ |

**–í–∞–∂–Ω–æ:** –í —Ç–∞–±–ª–∏—Ü–µ `SYSTEM` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å:
- `param` = `selectedGroupID`
- `value` = ID –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã (—á–∏—Å–ª–æ)

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∏–¥–∂–µ—Ç–∞

### –®–∞–≥ 1: –î–æ–±–∞–≤—å—Ç–µ Custom Widget

1. –í Grist –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
2. –ù–∞–∂–º–∏—Ç–µ **+** –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –≤–∏–¥–∂–µ—Ç–∞
3. –í—ã–±–µ—Ä–∏—Ç–µ **Custom Widget**
4. –í –ø–æ–ª–µ **Widget ID** –≤–≤–µ–¥–∏—Ç–µ: `bdcontrol`
5. –í –ø–æ–ª–µ **URL** —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ `index.html` –≤–∏–¥–∂–µ—Ç–∞
   - –ï—Å–ª–∏ –≤–∏–¥–∂–µ—Ç —Ä–∞–∑–º–µ—â—ë–Ω –ª–æ–∫–∞–ª—å–Ω–æ: `http://localhost:8080/index.html`
   - –ï—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: `https://your-server.com/widget/BDControl/index.html`

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–≤—è–∑–∏ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ (Mapping)

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–∂–µ—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω—É–∂–Ω–æ —Å–≤—è–∑–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã Grist —Å –ø–æ–ª—è–º–∏ –≤–∏–¥–∂–µ—Ç–∞:

1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–Ω–∞—á–æ–∫ **‚öôÔ∏è (Settings)** –≤–∏–¥–∂–µ—Ç–∞
2. –í —Ä–∞–∑–¥–µ–ª–µ **Widget Options** –≤—ã —É–≤–∏–¥–∏—Ç–µ –ø–æ–ª—è –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞:
   - `device_groups`
   - `device`
   - `SYSTEM`

3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞:

| –ü–æ–ª–µ –≤–∏–¥–∂–µ—Ç–∞     | –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É  |
| ---------------- | ----------------- |
| device_groups    | `device_groups`   |
| device           | `device`          |
| SYSTEM           | `SYSTEM`          |

**–í–∞–∂–Ω–æ:** –ò–º–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü –¥–æ–ª–∂–Ω—ã —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∏–º–µ–Ω–∞–º–∏ –≤ Grist.

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ `SYSTEM` –µ—Å—Ç—å –∑–∞–ø–∏—Å—å —Å `param = 'selectedGroupID'`
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `value` —Ä–∞–≤–Ω—ã–º ID —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –≥—Ä—É–ø–ø—ã –∏–∑ `device_groups`
3. –í–∏–¥–∂–µ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

1. –°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≥—Ä—É–ø–ø:
   ```
   –û—Å–≤–µ—â–µ–Ω–∏–µ (id=1)
    ‚îú‚îÄ –°–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∏ (id=4)
    ‚îî‚îÄ –õ–∞–º–ø—ã (id=5)
   ```

2. –î–æ–±–∞–≤—å—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –≥—Ä—É–ø–ø—ã 4 –∏ 5

3. –í —Ç–∞–±–ª–∏—Ü–µ `SYSTEM` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `value = 1`

4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í–∏–¥–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏–∑ –≥—Ä—É–ø–ø 4 –∏ 5

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

| –°–∏—Ç—É–∞—Ü–∏—è | –î–µ–π—Å—Ç–≤–∏–µ | –û–∂–∏–¥–∞–µ–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ |
| -------- | -------- | ------------------- |
| –ù–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ SYSTEM | –£–¥–∞–ª–∏—Ç–µ –∑–∞–ø–∏—Å—å `selectedGroupID` | ¬´–ì—Ä—É–ø–ø–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞¬ª |
| –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ID | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `value = 999` | ¬´–í—ã–±—Ä–∞–Ω–Ω–∞—è –≥—Ä—É–ø–ø–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞¬ª |
| –ü—É—Å—Ç–∞—è –≥—Ä—É–ø–ø–∞ | –í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É –±–µ–∑ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ | ¬´–í –¥–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø–µ –Ω–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤¬ª |

---

## üîç Troubleshooting

### –û—à–∏–±–∫–∞: ¬´KeyError 'device_groups'¬ª

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –≤–∏–¥–∂–µ—Ç–æ–º –∏–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `device_groups` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∂–µ—Ç–∞ (‚öôÔ∏è)
3. –í —Ä–∞–∑–¥–µ–ª–µ **Widget Options** –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –ø–æ–ª—è `device_groups`

### –û—à–∏–±–∫–∞: ¬´KeyError 'device'¬ª

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –≤–∏–¥–∂–µ—Ç–æ–º –∏–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `device` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∂–µ—Ç–∞ (‚öôÔ∏è)
3. –í —Ä–∞–∑–¥–µ–ª–µ **Widget Options** –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –ø–æ–ª—è `device`

### –û—à–∏–±–∫–∞: ¬´KeyError 'SYSTEM'¬ª

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –≤–∏–¥–∂–µ—Ç–æ–º –∏–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `SYSTEM` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∂–µ—Ç–∞ (‚öôÔ∏è)
3. –í —Ä–∞–∑–¥–µ–ª–µ **Widget Options** –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –ø–æ–ª—è `SYSTEM`

### –í–∏–¥–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ¬´–ì—Ä—É–ø–ø–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞¬ª

**–ü—Ä–∏—á–∏–Ω–∞:** –í —Ç–∞–±–ª–∏—Ü–µ `SYSTEM` –Ω–µ—Ç –∑–∞–ø–∏—Å–∏ —Å `param = 'selectedGroupID'`

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤—å—Ç–µ –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É `SYSTEM`:
   - `param` = `selectedGroupID`
   - `value` = ID –≥—Ä—É–ø–ø—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `1`)

### –í–∏–¥–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ¬´–í—ã–±—Ä–∞–Ω–Ω–∞—è –≥—Ä—É–ø–ø–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞¬ª

**–ü—Ä–∏—á–∏–Ω–∞:** –£–∫–∞–∑–∞–Ω–Ω—ã–π ID –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `device_groups`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `value` –≤ —Ç–∞–±–ª–∏—Ü–µ `SYSTEM`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≥—Ä—É–ø–ø–∞ —Å —Ç–∞–∫–∏–º ID —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ `device_groups`

### –í–∏–¥–∂–µ—Ç –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü—ã –ø—É—Å—Ç—ã –∏–ª–∏ –Ω–µ —Å–≤—è–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–∞–Ω–Ω—ã–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–ø–ø–∏–Ω–≥–∞ –≤ –≤–∏–¥–∂–µ—Ç–µ
3. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í–∏–¥–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º –≤–∫–ª—é—á–µ–Ω–∞ –ø–æ –∫–ª–∏–∫—É –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫
- –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏–µ—Ä–∞—Ä—Ö–∏–∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `parent_id` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `selectedGroupID` –≤ —Ç–∞–±–ª–∏—Ü–µ `SYSTEM` –≤–∏–¥–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Grist Custom Widgets](https://support.getgrist.com/custom-widgets/)
- [Grist Widget API](https://github.com/gristlabs/grist-widget)
